<!-- Header banner con logo de la universidad -->
<img 
  src="images/usco.svg" 
  alt="Universidad Surcolombiana" 
  class="w-full h-auto"
  onerror="this.style.display='none'; this.nextElementSibling.style.display='block'"
/>
<div style="display:none; color:red; font-weight:bold; padding: 10px;">LOGO NO CARGA - USCO</div>

<!-- T√≠tulo principal -->
<section class="py-8">
  <div class="container mx-auto px-4">
    <h1 class="text-3xl md:text-4xl font-usco-condensed-bold text-center text-usco-vino-dark mb-2">
      Proceso de Admisiones PER√çODO 2026-1
    </h1>
    <p class="text-center text-usco-gris text-lg font-usco">
      Sigue estos pasos para completar tu matr√≠cula exitosamente
    </p>
  </div>
</section>


<!-- Pasos de matr√≠cula -->
<main class="container mx-auto px-4 py-12">
  <div class="max-w-4xl mx-auto">
    <div class="relative">
      <div *ngFor="let step of steps; let isLast = last; let isFirst = first" class="relative">
        <!-- L√≠nea vertical conectora para cada paso (excepto el √∫ltimo) -->
        <div *ngIf="!isLast" class="absolute left-6 w-0.5 bg-usco-ocre-dark" 
             style="top: 48px; height: calc(100% + 32px);"></div>
        <!-- Estructura uniforme para todos los pasos -->
        <div class="flex items-center mb-8">
          <!-- N√∫mero fuera del banner -->
          <div class="w-12 h-12 text-white rounded-full flex items-center justify-center font-bold text-lg mr-8 flex-shrink-0 relative z-10 bg-usco-vino">
            {{ step.number }}
          </div>
          
          <!-- Banner para todos los pasos con imagen -->
          <div class="rounded-3xl shadow-xl cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-2xl"
            style="width: calc(100% - 80px);"
            (click)="showDialog(step)"
          >
            <img 
              [src]="'images/paso-' + step.number + '.png'" 
              [alt]="step.title"
              class="w-full h-auto rounded-3xl object-cover"
            />
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<!-- Modal personalizado con TailwindCSS -->
<div *ngIf="visible()" class="fixed inset-0 z-50 flex items-center justify-center" [ngClass]="closing() ? 'animate-fadeOut' : 'animate-fadeIn'">
  <!-- Fondo opacado -->
  <div class="modal-overlay" [ngClass]="closing() ? 'animate-fadeOut' : 'animate-fadeIn'" (click)="hideDialog()"></div>
  
  <!-- Modal -->
  <div class="relative bg-white rounded-lg shadow-xl w-[95vw] max-w-[1200px] max-h-[80vh] overflow-hidden" [ngClass]="closing() ? 'animate-scaleOut' : 'animate-scaleIn'">
    <!-- Header -->
    <div class="bg-usco-vino text-white px-6 py-4 flex justify-between items-center">
      <h3 class="text-lg font-usco-condensed-bold">
        Paso {{ selectedStep()?.number || '' }}: {{ selectedStep()?.title || '' }}
      </h3>
      <button (click)="hideDialog()" class="text-white hover:text-usco-vino-pale text-xl font-bold">
        √ó
      </button>
    </div>
    
    <!-- Contenido -->
    <div class="overflow-y-auto max-h-[70vh]" *ngIf="selectedStep()">
      <!-- Solo mostrar PDFs para el paso 1 -->
      <div *ngIf="selectedStep()!.number === 1 && selectedStep()!.pdfs && selectedStep()!.pdfs!.length > 0" class="p-4">
        <!-- Listado horizontal de sedes -->
        <div class="mb-6">
          <h4 class="text-lg font-usco-condensed-bold mb-4 text-usco-vino text-center">Selecciona tu sede de inter√©s</h4>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <button 
              *ngFor="let pdf of selectedStep()!.pdfs!; let i = index"
              (click)="selectPdf(i, pdf.url)"
              class="sede-button p-4 rounded-lg border-2 transition-all duration-200 hover:scale-105"
              [ngClass]="selectedPdfIndex() === i ? 
                'bg-usco-vino text-white border-usco-vino shadow-lg' : 
                'bg-white text-usco-gris border-usco-gris-lighter'">
              <div class="text-center">
                <div class="font-usco-bold text-sm">{{ pdf.name.replace('SEDE ', '') }}</div>
              </div>
            </button>
          </div>
        </div>
        
        <!-- Secci√≥n de la sede seleccionada -->
        <div *ngIf="selectedStep()!.pdfs && selectedStep()!.pdfs![selectedPdfIndex()]" class="border border-usco-gris-lighter rounded-lg overflow-hidden shadow-lg">
          <!-- Encabezado de la sede -->
          <div class="bg-usco-vino text-white p-4">
            <div class="flex justify-between items-center">
              <h5 class="font-usco-condensed-bold text-xl">{{ selectedStep()!.pdfs![selectedPdfIndex()].name }}</h5>
              <a [href]="selectedStep()!.pdfs![selectedPdfIndex()].url" 
                 target="_blank" 
                 class="bg-white text-usco-vino px-3 py-1 rounded font-usco text-sm hover:bg-usco-vino-pale">
                üìÑ Abrir PDF
              </a>
            </div>
          </div>
          
          <!-- Contenido del PDF -->
          <div class="bg-white p-4">
            <div *ngIf="!isBrowser()" class="flex items-center justify-center h-[400px] bg-gray-100 rounded">
              <p class="text-usco-gris">Cargando visor PDF...</p>
            </div>
            
            <div *ngIf="isBrowser()">
              
              <!-- Visor PDF con embed simple (como en PHP) -->
              <div class="border rounded bg-white p-4">
                <!-- Embed PDF directo -->
                <embed 
                  [src]="safePdfUrl()" 
                  width="98%" 
                  height="630" 
                  type="application/pdf"
                  class="rounded border" />
                
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Para otros pasos, mostrar contenido normal -->
      <div *ngIf="selectedStep()!.number !== 1" class="p-6">
        <!-- Descripci√≥n detallada -->
        <div *ngIf="selectedStep()!.detailedInfo" class="mb-6">
          <h4 class="text-lg font-usco-condensed-bold mb-3 text-usco-vino">Informaci√≥n detallada</h4>
          <p class="text-usco-gris-dark leading-relaxed font-usco">{{ selectedStep()!.detailedInfo }}</p>
        </div>

        <!-- Requisitos -->
        <div *ngIf="selectedStep()!.requirements && selectedStep()!.requirements!.length > 0" class="mb-6">
          <h4 class="text-lg font-usco-condensed-bold mb-3 text-usco-vino">Requisitos necesarios</h4>
          <ul class="space-y-2">
            <li *ngFor="let requirement of selectedStep()!.requirements!" class="flex items-start">
              <span class="text-usco-ocre-dark mr-2 text-lg">‚úì</span>
              <span class="text-usco-gris-dark font-usco">{{ requirement }}</span>
            </li>
          </ul>
        </div>

        <!-- Consejos -->
        <div *ngIf="selectedStep()!.tips && selectedStep()!.tips!.length > 0" class="mb-4">
          <h4 class="text-lg font-usco-condensed-bold mb-3 text-usco-vino">Consejos √∫tiles</h4>
          <ul class="space-y-2">
            <li *ngFor="let tip of selectedStep()!.tips!" class="flex items-start">
              <span class="text-usco-ocre-dark mr-2 text-lg">üí°</span>
              <span class="text-usco-gris-dark font-usco">{{ tip }}</span>
            </li>
          </ul>
        </div>
      </div>
    </div>
    
    <!-- Footer -->
    <div class="bg-usco-gris-pale px-6 py-4 flex justify-end border-t border-usco-gris-lightest">
      <button 
        (click)="hideDialog()"
        class="bg-usco-gris hover:bg-usco-gris-dark text-white px-4 py-2 rounded-md transition-colors duration-200 font-usco-bold"
      >
        Cerrar
      </button>
    </div>
  </div>
</div>

<router-outlet />
